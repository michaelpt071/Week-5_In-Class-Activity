<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.4.553">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>PA 4: Preparing the Youth Risk Behavior Analysis</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="pa-4-import-tidy-data_files/libs/clipboard/clipboard.min.js"></script>
<script src="pa-4-import-tidy-data_files/libs/quarto-html/quarto.js"></script>
<script src="pa-4-import-tidy-data_files/libs/quarto-html/popper.min.js"></script>
<script src="pa-4-import-tidy-data_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="pa-4-import-tidy-data_files/libs/quarto-html/anchor.min.js"></script>
<link href="pa-4-import-tidy-data_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="pa-4-import-tidy-data_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="pa-4-import-tidy-data_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="pa-4-import-tidy-data_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="pa-4-import-tidy-data_files/libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">


</head>

<body class="fullcontent">

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">

<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">PA 4: Preparing the Youth Risk Behavior Analysis</h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<!-- United States Department of Health and Human Services. Centers for Disease Control and Prevention. CDC Youth Risk Behavior Surveillance System (YRBSS) National Datasets, 1991-2021: YRBS_2021_national.csv. Ann Arbor, MI: Inter-university Consortium for Political and Social Research [distributor], 2025-02-04. https://doi.org/10.3886/E217921V1-168641 -->
<p><strong><em>This task is complex. It requires many different types of abilities. Everyone will be good at some of these abilities but nobody will be good at all of them. In order to solve this puzzle, you will need to use the skills of each member of your group.</em></strong></p>
<section id="groupwork-protocols" class="level2">
<h2 class="anchored" data-anchor-id="groupwork-protocols">Groupwork Protocols</h2>
<p>During the Practice Activity, you and your partner will alternate between two roles—Developer and Coder.</p>
<p>When you are the <strong>Developer</strong>, you will type into the Quarto document in RStudio. However, you <strong>do not</strong> type your own ideas. Instead, you type what the Coder tells you to type. You are permitted to ask the Coder clarifying questions, and, if both of you have a question, you are permitted to ask the professor. You are expected to run the code provided by the Coder and, if necessary, to work with the Coder to debug the code. Once the code runs, you are expected to collaborate with the Coder to write code comments that describe the actions taken by your code.</p>
<p>When you are the <strong>Coder</strong>, you are responsible for reading the instructions / prompts and directing the Developer what to type in the Quarto document. You are responsible for managing the resources your group has available to you (e.g., cheatsheet, textbook). If necessary, you should work with the Developer to debug the code you specified. Once the code runs, you are expected to collaborate with the Developer to write code comments that describe the actions taken by your code.</p>
<section id="group-norms" class="level3">
<h3 class="anchored" data-anchor-id="group-norms">Group Norms</h3>
<p>Remember, your group is expected to adhere to the following norms:</p>
<ol type="1">
<li>Think and work together. Do not divide the work.</li>
<li>You are smarter together.</li>
<li>No cross-talk with other groups.</li>
</ol>
</section>
</section>
<section id="goals-for-the-activity" class="level2">
<h2 class="anchored" data-anchor-id="goals-for-the-activity">Goals for the Activity</h2>
<ul>
<li>Solve issues in your data as you read it in by parsing out text from numbers, specifying NA values, and cleaning up variable names</li>
</ul>
<p><strong>THROUGHOUT</strong> the Activity be sure to follow the Style Guide by doing the following:</p>
<ul>
<li>load the appropriate packages at the beginning of the Rmarkdown<br>
</li>
<li>use proper spacing<br>
</li>
<li>name all code chunks<br>
</li>
<li>comment at least once in each code chunk to describe why you made your coding decisions<br>
</li>
<li>add appropriate labels to all graphic axes</li>
</ul>
</section>
<section id="youth-risk-behavior-surveillance-systems-yrbss" class="level2">
<h2 class="anchored" data-anchor-id="youth-risk-behavior-surveillance-systems-yrbss">Youth Risk Behavior Surveillance Systems (YRBSS)</h2>
<p>This data is from a survey given every other year called the Youth Risk Behavior Surveillance System administered by the Center for Disease Control and Prevention. The survey monitors health risks among youth, such as violence, sexually transmitted diseases, tobacco, and alcohol use.</p>
<p>The data set contains over 100,000 rows from 2023. A code book is also provided that gives extensive information on the survey. The data can be stored in an Excel or spreadsheet program, but it cannot be manipulated in those programs because of its size - this why we need R.</p>
<!-- The partner who most recently watched an Avengers movies is the  -->
<!-- Developer (typing and listening to instructions from the Coder! -->
</section>
<section id="setting-up-your-project" class="level2">
<h2 class="anchored" data-anchor-id="setting-up-your-project">Setting up your Project</h2>
<p>Your project should have the following components:</p>
<ol type="1">
<li><code>data-raw</code> folder that contains the provided data set<br>
</li>
<li><code>data-clean</code> that will eventually hold your cleaned up data<br>
</li>
<li>completed <code>.qmd</code> and rendered file</li>
</ol>
<section id="step-1-attempt-to-read-in-the-data" class="level3">
<h3 class="anchored" data-anchor-id="step-1-attempt-to-read-in-the-data">Step 1: Attempt to Read in the Data</h3>
<p>Go ahead and read in the data, calling it <code>youth</code>. What do you notice?</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a>youth <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">"raw_data/YRBS2015.csv"</span>, </span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>                  <span class="at">skip =</span> <span class="dv">1</span>,</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a>                  <span class="at">na =</span> <span class="fu">c</span>(<span class="st">"N/A"</span>, <span class="st">"."</span>),</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a>                  <span class="at">col_types =</span> <span class="fu">list</span>(<span class="st">"AgeCat"</span> <span class="ot">=</span> <span class="fu">col_number</span>(),</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a>                                   <span class="st">"Grade"</span> <span class="ot">=</span> <span class="fu">col_number</span>(),</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a>                                   <span class="st">"Gender"</span> <span class="ot">=</span> <span class="fu">col_character</span>(),</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a>                                   <span class="st">"Height in meters"</span> <span class="ot">=</span> <span class="fu">col_double</span>(),</span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a>                                   <span class="st">"Weight in kilograms"</span>  <span class="ot">=</span> <span class="fu">col_double</span>(),</span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a>                                   <span class="st">"Body Mass Index"</span> <span class="ot">=</span> <span class="fu">col_double</span>(),</span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a>                                   <span class="st">"BMI percentile"</span> <span class="ot">=</span> <span class="fu">col_integer</span>(),</span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a>                                   <span class="st">"Fruit eating"</span> <span class="ot">=</span> <span class="fu">col_character</span>(),</span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a>                                   <span class="st">"Salad eating"</span> <span class="ot">=</span> <span class="fu">col_character</span>(),</span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a>                                   <span class="st">"Other vegetable eating"</span> <span class="ot">=</span> <span class="fu">col_character</span>(),</span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a>                                   <span class="st">"Soda drinking"</span> <span class="ot">=</span> <span class="fu">col_character</span>(),</span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a>                                   <span class="st">"Breakfast eating"</span> <span class="ot">=</span> <span class="fu">col_number</span>(),</span>
<span id="cb1-16"><a href="#cb1-16" aria-hidden="true" tabindex="-1"></a>                                   <span class="st">"Physical activity &gt;= 5 days"</span> <span class="ot">=</span> <span class="fu">col_number</span>(),</span>
<span id="cb1-17"><a href="#cb1-17" aria-hidden="true" tabindex="-1"></a>                                   <span class="st">"Television watching"</span> <span class="ot">=</span> <span class="fu">col_character</span>(),</span>
<span id="cb1-18"><a href="#cb1-18" aria-hidden="true" tabindex="-1"></a>                                   <span class="st">"Sports team participation"</span> <span class="ot">=</span> <span class="fu">col_number</span>(),</span>
<span id="cb1-19"><a href="#cb1-19" aria-hidden="true" tabindex="-1"></a>                                   <span class="st">"Perception of weight"</span> <span class="ot">=</span> <span class="fu">col_factor</span>(<span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"Very underweight"</span>,<span class="st">"Slightly underweight"</span>, <span class="st">"About the right weight"</span>, <span class="st">"Slightly overweight"</span>, <span class="st">"Very overweight"</span>)),</span>
<span id="cb1-20"><a href="#cb1-20" aria-hidden="true" tabindex="-1"></a>                                   <span class="at">.default =</span> <span class="fu">col_skip</span>()))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Describe some of the issues you notice in the data:</p>
<blockquote class="blockquote">
<p>Read numeric data as character data</p>
</blockquote>
</section>
<section id="step-2-skip-the-first-row" class="level3">
<h3 class="anchored" data-anchor-id="step-2-skip-the-first-row">Step 2: Skip the First Row</h3>
<p>Using either the <code>help</code> options or the <code>readr</code> add an argument to the code above that will skip the first row of the data file so that the ‘headers’ (column titles) read in correctly.</p>
</section>
<section id="step-3-fix-the-missing-values" class="level3">
<h3 class="anchored" data-anchor-id="step-3-fix-the-missing-values">Step 3: Fix the Missing Values</h3>
<p>Take note of how missing values are designated in the data. Add an argument to the code above that identifies and fixes the data so that each missing value type is treated as the same <code>NA</code>.</p>
<!-- Change roles (Developer becomes Coder)! -->
</section>
<section id="step-4-clean-a-few-of-the-variables" class="level3">
<h3 class="anchored" data-anchor-id="step-4-clean-a-few-of-the-variables">Step 4: Clean A few of the Variables</h3>
<p>Add additional arguments to the code above that does the following:</p>
<ul>
<li><code>AgeCat</code>: remove the text “years old” from the numeric values<br>
</li>
<li><code>Grade</code>: remove the text “th grade” from the numeric values<br>
</li>
<li><code>Perception of weight</code>: read as a factor with the following
<ul>
<li><code>levels = c("Very underweight","Slightly underweight", "About the right weight", "Slightly overweight", "Very overweight")</code></li>
</ul></li>
<li>Set the following variables to the right data type:
<ul>
<li><code>Gender</code><br>
</li>
<li><code>Height in meters</code><br>
</li>
<li><code>Weight in kilograms</code><br>
</li>
<li><code>Body Mass Index</code></li>
<li><code>BMI percentile</code><br>
</li>
<li><code>Fruit eating</code><br>
</li>
<li><code>Salad eating</code></li>
<li><code>Other vegetable eating</code></li>
<li><code>Soda drinking</code></li>
<li><code>Breakfast eating</code></li>
<li><code>Physical activity &gt;= 5 days</code></li>
<li><code>Television watching</code></li>
<li><code>Sports team participation</code><br>
</li>
</ul></li>
<li>Skip the rest of the variables (hint set <code>.default = _________</code>)</li>
</ul>
<!-- Change roles (Developer becomes Coder)! -->
</section>
<section id="step-5-clean-the-variable-names" class="level3">
<h3 class="anchored" data-anchor-id="step-5-clean-the-variable-names">Step 5: Clean the Variable Names</h3>
<p>Use the <code>janitor</code> package to clean the variable names to snake_case.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>youth <span class="ot">&lt;-</span> <span class="fu">clean_names</span>(youth)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="step-6-write-the-clean-data" class="level3">
<h3 class="anchored" data-anchor-id="step-6-write-the-clean-data">Step 6: Write the Clean Data</h3>
<p>Write the clean data to the <code>data-clean</code> folder.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="fu">write_csv</span>(youth, <span class="st">"clean_data/youth_clean.csv"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Now that the data is clean, you can add <code>eval: false</code> to the prior code chunks and read in the clean data below.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>youth_clean <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">"clean_data/youth_clean.csv"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Why do we keep the code for the data cleaning but set the code chunks to <code>eval: false</code>?</p>
<blockquote class="blockquote">
<p>We only want to clean the code once to save time and power</p>
</blockquote>
<!-- Change roles (Developer becomes Coder)! -->
</section>
<section id="step-7-explore-missingness" class="level3">
<h3 class="anchored" data-anchor-id="step-7-explore-missingness">Step 7: Explore Missingness</h3>
<p>Look at the following graphs</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>youth_clean <span class="sc">|&gt;</span> </span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>  naniar<span class="sc">::</span><span class="fu">gg_miss_var</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>youth_clean <span class="sc">|&gt;</span> </span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>    naniar<span class="sc">::</span><span class="fu">gg_miss_upset</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>What do the two graphs tell you about the missingness in the data (i.e., which variables are missing the most values and which combinations of variables are missing the most together)?</p>
<blockquote class="blockquote">
<p>The first graph specifies the number of missing values for each variable, and the second graph visualizes the overlap of those missing values.</p>
</blockquote>
<p>How does the missingness of the data impact what variables you might choose to analyze? Why?</p>
<blockquote class="blockquote">
<p>It limits the study to certian types of analysis of variables, depending on their missingness.</p>
</blockquote>
<!-- Change roles (Developer becomes Coder)! -->
</section>
<section id="step-8-make-a-visualization" class="level3">
<h3 class="anchored" data-anchor-id="step-8-make-a-visualization">Step 8: Make a Visualization</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>youth_clean <span class="sc">|&gt;</span>  <span class="co">#instead of data = youth_clean in ggplot we can "pipe" our data  </span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">drop_na</span>() <span class="sc">|&gt;</span>  <span class="co">#drops missing values</span></span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> <span class="st">"height_in_meters"</span>, <span class="at">y =</span> <span class="st">"weight_in_kilograms"</span>,</span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a>                           <span class="at">colour =</span> <span class="st">"perception_of_weight"</span>)) <span class="sc">+</span></span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> lm, <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> <span class="st">"height_in_meters"</span>, <span class="at">y =</span> <span class="st">"weight_in_kilograms"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Complete the following steps in your visualization in the code chunk above:</p>
<ul>
<li>Plot the height on the x-axis<br>
</li>
<li>Plot the weight on the y-axis<br>
</li>
<li>Color the points based on student perception of weight<br>
</li>
<li>Add a linear model (use <code>method = "lm"</code> and geom_smooth())</li>
<li>Make the points more transparent<br>
</li>
<li>Facet by grade and gender<br>
</li>
<li>Add descriptive titles and labels<br>
</li>
<li>Export the graph as the file <code>weight-perception.png</code></li>
</ul>
<!-- Change roles (Developer becomes Coder)! -->
<p><strong>Challenge Modifications</strong></p>
<ul>
<li>Make the points a color-blind friendly color scale<br>
</li>
<li>Change the general theme of the graph<br>
</li>
<li>Move the legend to the bottom of the graph<br>
</li>
<li>Adjust the figure height and width to 10x10</li>
</ul>
</section>
</section>
<section id="canvas-quiz" class="level1">
<h1>Canvas Quiz</h1>
<p>Working together as a team, the above analysis to answer the following questions on canvas:</p>
<ol type="1">
<li><p>Which variable has the most missing values?</p></li>
<li><p>Which variable combination has the most missing values?</p></li>
</ol>
<p>Be ready to submit the complete project, with files rendered and created data and image files.</p>
</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->




</body></html>